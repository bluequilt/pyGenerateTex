# 总纲要
- 本程序统一样式
  - 所有固定宽度为毫米mm，小数位数2位
  - 字符串格式化函数统一使用``"我%s一个" % ("是","字符串")``样式
- Tex模板文件不允许使用自动调整缩进样式的功能
- 关于字符 ``\`` 的转义
  - py文件
    - 可以通过r修饰符来保证字面量的``\``的数量和实际一致。然而因为r修饰符实际上认为这是一个正则表达式字符串，会导致VS Code配色混乱，所以正常使用普通字符串字面量，用``\\``表示真实的``\``
  - tex文件
    - 正常文本环境中无转义
    - 在模板文件中，为包含在变量块里的函数设置字符串字面量时，字符串字面量符合Python规范，要加引号，并且不能有r修饰符，也就意味着要用``\\``表示真实的``\``。这会使文档各处的转义情况不一致，会使编辑者产生一定的混乱。另外，这种字符串字面量会使VS Code的Tex配色系统混乱
- 注意其他字符，如``<, #, $, %, &, ^, _, @``等的转义
# 表格环境
1. __init__参数解释：
- col_lens
  - 形如``["20mm",2,3,1,"25mm"]``
  - 可以混搭着写固定宽度和相对宽度，相对宽度的解释为，在表格总宽度中先减去所有固定宽度，再把剩下的宽度按比例分给所有相对宽度的列
  - 固定宽度必须是字符串，相对宽度必须是数字
  - 传入的宽度指含有边距的总宽度，经过计算后，实际内容的宽度和参数中传入的值会有差别。
- tabcolsep
  - 和LaTex定义相同，是单元格边距的一半
- tablewidth
  - 表格的总宽度，通常这个数由Geometry的设定算出，表格配置中写0
- 初始化是一次性的，所有参数都不能再修改，需确保所有参数都无误后再初始化

表格的定义在模板中的写法如下，定义中的``c``最后并不影响内容的实际对齐方式，也无需在表格中指定宽度
```tex
\begin{tabular}{|c|c|c|c|c|}
...
\end{tabular}
```
2. 表格中的每一项都是一个``\parbox``，该盒子的参数决定了单元格的宽度和对齐方式，高度则是由LaTeX决定，取决于每一行内容最多的单元格
3. 关于合并单元格的解释
- 行和列的地位并不平等，列的优先级高，这决定了表格环境的设计理念
- 合并一行中的多列
  - 使用过一个合并单元格后，本行使用的&amp;符号可以少一个，相当于可以少写一列
  - ``\parbox``在``\multicolumn``里面，这也是表头不采用``p{}``系列的原因，合并单元格和盒子的嵌套关系必须精确控制
  - ``\multicolumn``的第二个参数应固定为``|c|``
```tex
\multicolumn{<列数>}{|c|}{\parbox[c][][c]{<宽度>}{内容}}
```
- 合并一列中的多行
  - 在被合并的第一行填入合并单元格的实际内容，后面的行什么也不写，在写法上，行首出现&amp;或行中出现连续的2个&amp;，这都是正常的
  - 需要周围的行配合使用``\cline``绘制正确的横线
  - 如例，内容2和内容3其实在同一列
```tex
\multirow{<行数>}*{\parbox[c][][c]{<宽度>}{内容}}&内容2\\
&内容3
```
- 合并多行和多列
  - 这种情况理应只出现在复杂的表头上，其他地方极其不推荐，使用前一定要先在测试文件中调试
  - 除了该大单元格的第一行之外的行，在本应什么也不写的那个多列型单元格的第一格填上``\multicolumn``，参数中的合并列数正常写，而内容为空。
  - 第一行嵌套关系如例
```tex
\multicolumn{<列数>}{|c|}{
    \multirow{<行数>}*{
        \parbox[c][][c]{<宽度>}{内容}
    }
}
```
4. 在模板中，写完每个单元格及后面的&amp;，都需要回车，以提高最终生成的文档的可读性